<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Keep your existing head content -->
    <!-- Add OpenAI API -->
    <script src="https://cdn.jsdelivr.net/npm/openai@4.0.0/dist/openai.min.js"></script>
</head>
<body>
    <!-- Keep your existing nav and container HTML -->

    <script>
        // Initialize OpenAI - Replace with your API key
        const OPENAI_API_KEY = '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'; // Replace this with your actual OpenAI API key
        
        async function askQuestion() {
            const input = document.getElementById('userInput');
            const chatBox = document.getElementById('chatBox');
            const question = input.value.trim();
            
            if (!question) return;

            // Add user message
            addMessage(question, 'user');
            input.value = '';

            try {
                // Show loading state
                const loadingId = addMessage('Thinking...', 'ai loading');
                
                // Call OpenAI API directly
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: "gpt-3.5-turbo",
                        messages: [
                            {
                                role: "system",
                                content: "You are a knowledgeable Islamic AI assistant. Provide accurate and respectful answers based on Quran and authentic Hadith. If you're not certain about any aspect, clearly state that. Always provide references when possible."
                            },
                            {
                                role: "user",
                                content: question
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 500
                    })
                });

                const data = await response.json();

                // Remove loading message
                removeMessage(loadingId);

                if (data.choices && data.choices[0].message.content) {
                    addMessage(data.choices[0].message.content, 'ai');
                } else {
                    addMessage('I apologize, but I could not generate a proper response. Please try rephrasing your question.', 'ai error-message');
                }
            } catch (error) {
                console.error('Error:', error);
                addMessage('I apologize for the error. Please try again in a moment.', 'ai error-message');
            }
        }

        // Keep your existing helper functions (addMessage, removeMessage, etc.)
    </script>
</body>
</html>
